<div class="dashboard-layout">
  <app-sidebar></app-sidebar>

  <div class="dashboard-container">
    <h2 class="my-4">Liste des Maladies</h2>

    <!-- Barre de recherche -->
    <div class="d-flex justify-content-between mb-3">
      <input
        type="text"
        class="form-control me-2"
        placeholder="Rechercher par nom maladie"
        [value]="selectedNom_maladie"
        (input)="onSearchNomMaladie($event)"
      />
      <input
        type="text"
        class="form-control me-2"
        placeholder="Rechercher par nom"
        [value]="selectedName"
        (input)="onSearchName($event)"
      />
    </div>

    <a routerLink="/maladies/add" class="btn btn-primary mb-3">Ajouter une maladie</a>

    <!-- Tableau des maladies -->
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nom</th>
          <th>Prénom</th>
          <th>Nom Maladies</th>
          <th>Description</th>
          <th>Medicament</th>
          <th>Dosage</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let maladie of maladies">
          <td>{{ maladie.id }}</td>
          <td>{{ maladie.patient_nom }}</td>
          <td>{{ maladie.patient_prenom }}</td>
          <td>{{ maladie.nom_maladie }}</td>
          <td>{{ maladie.description }}</td>
          <td>{{ maladie.medicament }}</td>
          <td>{{ maladie.dosage }}</td>
          <td class="d-flex justify-content-center align-items-center gap-2">
            <button mat-icon-button color="primary" routerLink="/maladies/edit/{{maladie.id}}">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="handleDelete(maladie.id)">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button color="accent" routerLink="/maladies/view/{{maladie.id}}">
              <mat-icon>visibility</mat-icon>
            </button>
          </td>
        </tr>
        <tr *ngIf="maladies.length === 0">
          <td colspan="8" class="text-center">Aucune maladie trouvée</td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="d-flex justify-content-end mt-3">
      <nav>
        <ul class="pagination">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <button class="page-link" (click)="handlePageChange(currentPage - 1)">Précédent</button>
          </li>

          <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index"
              [class.active]="i + 1 === currentPage">
            <button class="page-link" (click)="handlePageChange(i + 1)">{{ i + 1 }}</button>
          </li>

          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <button class="page-link" (click)="handlePageChange(currentPage + 1)">Suivant</button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
